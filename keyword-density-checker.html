<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="icon" href="favicon-16x16.png" type="image/x-icon">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Keyword Density Checker | QuickPDFTool</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-blue: #2c7be5;
            --secondary-blue: #6ea8fe;
            --light-blue: #e8f2ff;
            --dark-blue: #1c5fb8;
            --white: #ffffff;
            --light-gray: #f8f9fa;
            --medium-gray: #e9ecef;
            --dark-gray: #6c757d;
            --text-color: #333333;
            --shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            --border-radius: 10px;
            --success-green: #28a745;
            --warning-orange: #fd7e14;
            --keyword-1: #2c7be5;
            --keyword-2: #28a745;
            --keyword-3: #fd7e14;
            --keyword-4: #dc3545;
            --keyword-5: #6f42c1;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: var(--light-gray);
            color: var(--text-color);
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px 0;
        }
        
        .logo {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            color: var(--primary-blue);
            margin-bottom: 10px;
        }
        
        .logo i {
            font-size: 2.2rem;
        }
        
        .logo h1 {
            font-size: 2.2rem;
            font-weight: 700;
        }
        
        header p {
            color: var(--dark-gray);
            font-size: 1.1rem;
            max-width: 700px;
            margin: 0 auto;
        }
        
        .tool-container {
            background-color: var(--white);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            overflow: hidden;
            margin-bottom: 30px;
        }
        
        .tool-title {
            background-color: var(--primary-blue);
            color: var(--white);
            padding: 18px 30px;
            font-size: 1.5rem;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .tool-title i {
            font-size: 1.4rem;
        }
        
        .tool-content {
            padding: 30px;
        }
        
        .input-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }
        
        @media (max-width: 992px) {
            .input-section {
                grid-template-columns: 1fr;
                gap: 20px;
            }
        }
        
        .text-input-area {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .text-input-label {
            font-weight: 600;
            color: var(--dark-blue);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .text-input-label i {
            font-size: 1.1rem;
        }
        
        .text-area-container {
            position: relative;
            flex: 1;
        }
        
        textarea {
            width: 100%;
            height: 300px;
            padding: 20px;
            border: 2px solid var(--medium-gray);
            border-radius: var(--border-radius);
            font-size: 1rem;
            line-height: 1.6;
            resize: vertical;
            transition: all 0.3s;
        }
        
        textarea:focus {
            outline: none;
            border-color: var(--secondary-blue);
            box-shadow: 0 0 0 3px rgba(44, 123, 229, 0.1);
        }
        
        .text-counter {
            position: absolute;
            bottom: 15px;
            right: 15px;
            background-color: rgba(44, 123, 229, 0.1);
            color: var(--dark-blue);
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }
        
        .control-panel {
            display: flex;
            flex-direction: column;
            gap: 25px;
        }
        
        .control-group {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        .control-label {
            font-weight: 600;
            color: var(--dark-blue);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .control-label i {
            font-size: 1.1rem;
        }
        
        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 5px;
        }
        
        .checkbox-group input[type="checkbox"] {
            width: 18px;
            height: 18px;
            accent-color: var(--primary-blue);
            cursor: pointer;
        }
        
        .checkbox-group label {
            cursor: pointer;
            font-weight: 500;
        }
        
        .slider-control {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .slider-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .slider-value {
            font-weight: 600;
            color: var(--primary-blue);
            min-width: 40px;
            text-align: right;
        }
        
        input[type="range"] {
            width: 100%;
            height: 8px;
            -webkit-appearance: none;
            appearance: none;
            background: var(--medium-gray);
            border-radius: 4px;
            outline: none;
        }
        
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 22px;
            height: 22px;
            border-radius: 50%;
            background: var(--primary-blue);
            cursor: pointer;
            border: 3px solid var(--white);
            box-shadow: 0 1px 4px rgba(0, 0, 0, 0.2);
        }
        
        .action-buttons {
            display: flex;
            gap: 15px;
            margin-top: 10px;
            flex-wrap: wrap;
        }
        
        .action-btn {
            flex: 1;
            padding: 14px 20px;
            border: none;
            border-radius: var(--border-radius);
            cursor: pointer;
            font-weight: 600;
            font-size: 1rem;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            min-width: 160px;
        }
        
        @media (max-width: 576px) {
            .action-btn {
                min-width: 100%;
            }
        }
        
        .analyze-btn {
            background-color: var(--primary-blue);
            color: var(--white);
        }
        
        .analyze-btn:hover {
            background-color: var(--dark-blue);
        }
        
        .clear-btn {
            background-color: var(--warning-orange);
            color: var(--white);
        }
        
        .clear-btn:hover {
            background-color: #e06b1e;
        }
        
        .sample-btn {
            background-color: var(--dark-gray);
            color: var(--white);
        }
        
        .sample-btn:hover {
            background-color: #5a6268;
        }
        
        .results-section {
            margin-top: 40px;
        }
        
        .results-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .results-title {
            font-size: 1.4rem;
            font-weight: 700;
            color: var(--dark-blue);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .results-actions {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .results-action-btn {
            padding: 10px 18px;
            background-color: var(--light-blue);
            border: none;
            border-radius: var(--border-radius);
            cursor: pointer;
            font-weight: 600;
            font-size: 0.9rem;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .results-action-btn:hover {
            background-color: var(--secondary-blue);
            color: var(--white);
        }
        
        .results-action-btn.copied {
            background-color: var(--success-green);
            color: var(--white);
        }
        
        .summary-cards {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }
        
        @media (max-width: 992px) {
            .summary-cards {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        @media (max-width: 576px) {
            .summary-cards {
                grid-template-columns: 1fr;
            }
        }
        
        .summary-card {
            background-color: var(--white);
            border-radius: var(--border-radius);
            padding: 25px 20px;
            text-align: center;
            box-shadow: var(--shadow);
            border-top: 4px solid var(--primary-blue);
        }
        
        .summary-card:nth-child(2) {
            border-top-color: var(--keyword-2);
        }
        
        .summary-card:nth-child(3) {
            border-top-color: var(--keyword-3);
        }
        
        .summary-card:nth-child(4) {
            border-top-color: var(--keyword-4);
        }
        
        .card-value {
            font-size: 2.5rem;
            font-weight: 800;
            margin-bottom: 10px;
            color: var(--dark-blue);
        }
        
        .card-label {
            font-size: 1rem;
            color: var(--dark-gray);
            font-weight: 600;
        }
        
        .keywords-container {
            background-color: var(--light-blue);
            border-radius: var(--border-radius);
            padding: 25px;
            margin-bottom: 30px;
        }
        
        .keywords-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .keywords-title {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--dark-blue);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .keywords-filter {
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 600;
            color: var(--dark-gray);
        }
        
        .keywords-filter select {
            padding: 8px 15px;
            border: 2px solid var(--medium-gray);
            border-radius: var(--border-radius);
            font-weight: 600;
            color: var(--dark-blue);
            background-color: var(--white);
            cursor: pointer;
        }
        
        .keywords-filter select:focus {
            outline: none;
            border-color: var(--secondary-blue);
        }
        
        .keywords-table-container {
            overflow-x: auto;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
        }
        
        .keywords-table {
            width: 100%;
            border-collapse: collapse;
            background-color: var(--white);
            min-width: 600px;
        }
        
        .keywords-table thead {
            background-color: var(--primary-blue);
            color: var(--white);
        }
        
        .keywords-table th {
            padding: 18px 15px;
            text-align: left;
            font-weight: 600;
            font-size: 1rem;
        }
        
        .keywords-table th:first-child {
            border-top-left-radius: var(--border-radius);
        }
        
        .keywords-table th:last-child {
            border-top-right-radius: var(--border-radius);
        }
        
        .keywords-table tbody tr {
            border-bottom: 1px solid var(--medium-gray);
            transition: background-color 0.2s;
        }
        
        .keywords-table tbody tr:hover {
            background-color: var(--light-blue);
        }
        
        .keywords-table td {
            padding: 15px;
            font-size: 0.95rem;
        }
        
        .keyword-cell {
            font-weight: 600;
            color: var(--dark-blue);
        }
        
        .frequency-cell {
            text-align: center;
            font-weight: 600;
        }
        
        .percentage-cell {
            text-align: center;
            font-weight: 600;
            color: var(--primary-blue);
        }
        
        .percentage-bar-container {
            width: 100%;
            height: 10px;
            background-color: var(--medium-gray);
            border-radius: 5px;
            overflow: hidden;
        }
        
        .percentage-bar {
            height: 100%;
            background-color: var(--primary-blue);
            border-radius: 5px;
        }
        
        .visualization-section {
            margin-top: 30px;
        }
        
        .visualization-title {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--dark-blue);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .visualization-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }
        
        @media (max-width: 768px) {
            .visualization-container {
                grid-template-columns: 1fr;
                gap: 20px;
            }
        }
        
        .chart-container {
            background-color: var(--white);
            border-radius: var(--border-radius);
            padding: 25px;
            box-shadow: var(--shadow);
        }
        
        .chart-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--dark-blue);
            margin-bottom: 20px;
            text-align: center;
        }
        
        .chart-placeholder {
            height: 250px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--dark-gray);
            font-weight: 600;
            background-color: var(--light-blue);
            border-radius: var(--border-radius);
        }
        
        .word-cloud {
            height: 250px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-wrap: wrap;
            gap: 10px;
            padding: 20px;
            background-color: var(--light-blue);
            border-radius: var(--border-radius);
        }
        
        .cloud-word {
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: 600;
            transition: all 0.2s;
            cursor: pointer;
        }
        
        .cloud-word:hover {
            transform: translateY(-3px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        
        .instructions {
            background-color: var(--light-blue);
            border-radius: var(--border-radius);
            padding: 20px;
            margin-top: 30px;
        }
        
        .instructions h3 {
            color: var(--primary-blue);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .instructions ul {
            padding-left: 20px;
            color: var(--dark-gray);
        }
        
        .instructions li {
            margin-bottom: 8px;
        }
        
        footer {
            text-align: center;
            padding: 20px 0;
            color: var(--dark-gray);
            font-size: 0.9rem;
            border-top: 1px solid var(--medium-gray);
            margin-top: 30px;
        }
        
        /* Responsive adjustments */
        @media (max-width: 768px) {
            .tool-title {
                padding: 15px 20px;
                font-size: 1.3rem;
            }
            
            .tool-content {
                padding: 20px;
            }
            
            textarea {
                height: 250px;
            }
        }
        
        @media (max-width: 480px) {
            .logo h1 {
                font-size: 1.8rem;
            }
            
            .keywords-header {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .keywords-filter {
                width: 100%;
                justify-content: space-between;
            }
        }
        
        /* No results state */
        .no-results {
            text-align: center;
            padding: 50px 20px;
            color: var(--dark-gray);
        }
        
        .no-results i {
            font-size: 3rem;
            margin-bottom: 15px;
            color: var(--secondary-blue);
        }
        
        .no-results h3 {
            font-size: 1.5rem;
            margin-bottom: 10px;
            color: var(--dark-blue);
        }
        
        /* Loading spinner */
        .spinner {
            display: none;
            width: 40px;
            height: 40px;
            border: 4px solid var(--light-blue);
            border-top: 4px solid var(--primary-blue);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 30px auto;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .loading .spinner {
            display: block;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">
                <i class="fas fa-chart-bar"></i>
                <h1>QuickPDFTool Keyword Density Checker</h1>
            </div>
            <p>Analyze your text to find keyword frequency and density. Perfect for SEO optimization and content analysis.</p>
        </header>
        
        <main>
            <div class="tool-container">
                <div class="tool-title">
                    <i class="fas fa-search"></i>
                    <span>Keyword Density Analyzer</span>
                </div>
                
                <div class="tool-content">
                    <div class="input-section">
                        <div class="text-input-area">
                            <div class="text-input-label">
                                <i class="fas fa-font"></i>
                                <span>Enter or Paste Your Text</span>
                            </div>
                            <div class="text-area-container">
                                <textarea id="textInput" placeholder="Paste your text here to analyze keyword density..."></textarea>
                                <div class="text-counter">
                                    <span id="wordCount">0</span> words
                                </div>
                            </div>
                        </div>
                        
                        <div class="control-panel">
                            <div class="control-group">
                                <div class="control-label">
                                    <i class="fas fa-filter"></i>
                                    <span>Analysis Settings</span>
                                </div>
                                
                                <div class="checkbox-group">
                                    <input type="checkbox" id="excludeStopWords" checked>
                                    <label for="excludeStopWords">Exclude common stop words (the, and, is, etc.)</label>
                                </div>
                                
                                <div class="checkbox-group">
                                    <input type="checkbox" id="caseSensitive">
                                    <label for="caseSensitive">Case-sensitive analysis</label>
                                </div>
                                
                                <div class="checkbox-group">
                                    <input type="checkbox" id="ignoreNumbers">
                                    <label for="ignoreNumbers">Ignore numbers</label>
                                </div>
                            </div>
                            
                            <div class="control-group">
                                <div class="control-label">
                                    <i class="fas fa-sliders-h"></i>
                                    <span>Minimum Word Length</span>
                                </div>
                                <div class="slider-control">
                                    <div class="slider-header">
                                        <span>Only analyze words with at least:</span>
                                        <span class="slider-value" id="minLengthValue">3</span>
                                    </div>
                                    <input type="range" id="minLengthSlider" min="1" max="10" value="3">
                                </div>
                            </div>
                            
                            <div class="control-group">
                                <div class="control-label">
                                    <i class="fas fa-sort-amount-up"></i>
                                    <span>Results Limit</span>
                                </div>
                                <div class="slider-control">
                                    <div class="slider-header">
                                        <span>Show top results:</span>
                                        <span class="slider-value" id="resultsLimitValue">25</span>
                                    </div>
                                    <input type="range" id="resultsLimitSlider" min="10" max="100" value="25" step="5">
                                </div>
                            </div>
                            
                            <div class="action-buttons">
                                <button class="action-btn analyze-btn" id="analyzeBtn">
                                    <i class="fas fa-chart-bar"></i>
                                    <span>Analyze Text</span>
                                </button>
                                <button class="action-btn clear-btn" id="clearBtn">
                                    <i class="fas fa-eraser"></i>
                                    <span>Clear Text</span>
                                </button>
                                <button class="action-btn sample-btn" id="sampleBtn">
                                    <i class="fas fa-file-alt"></i>
                                    <span>Load Sample</span>
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="results-section">
                        <div class="results-header">
                            <div class="results-title">
                                <i class="fas fa-poll"></i>
                                <span>Analysis Results</span>
                            </div>
                            
                            <div class="results-actions">
                                <button class="results-action-btn" id="exportBtn">
                                    <i class="fas fa-download"></i>
                                    <span>Export Results</span>
                                </button>
                                <button class="results-action-btn" id="copyBtn">
                                    <i class="far fa-copy"></i>
                                    <span>Copy Results</span>
                                </button>
                            </div>
                        </div>
                        
                        <div class="summary-cards">
                            <div class="summary-card">
                                <div class="card-value" id="totalWords">0</div>
                                <div class="card-label">Total Words</div>
                            </div>
                            <div class="summary-card">
                                <div class="card-value" id="uniqueWords">0</div>
                                <div class="card-label">Unique Words</div>
                            </div>
                            <div class="summary-card">
                                <div class="card-value" id="keywordCount">0</div>
                                <div class="card-label">Keywords Found</div>
                            </div>
                            <div class="summary-card">
                                <div class="card-value" id="avgDensity">0%</div>
                                <div class="card-label">Avg. Density</div>
                            </div>
                        </div>
                        
                        <div class="keywords-container">
                            <div class="keywords-header">
                                <div class="keywords-title">
                                    <i class="fas fa-key"></i>
                                    <span>Keyword Density Analysis</span>
                                </div>
                                
                                <div class="keywords-filter">
                                    <span>Sort by:</span>
                                    <select id="sortBy">
                                        <option value="frequency">Frequency (High to Low)</option>
                                        <option value="frequency-asc">Frequency (Low to High)</option>
                                        <option value="density">Density (High to Low)</option>
                                        <option value="density-asc">Density (Low to High)</option>
                                        <option value="alphabetical">Alphabetical (A-Z)</option>
                                        <option value="alphabetical-desc">Alphabetical (Z-A)</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="keywords-table-container">
                                <table class="keywords-table" id="keywordsTable">
                                    <thead>
                                        <tr>
                                            <th width="40%">Keyword</th>
                                            <th width="20%">Frequency</th>
                                            <th width="20%">Density</th>
                                            <th width="20%">Percentage</th>
                                        </tr>
                                    </thead>
                                    <tbody id="keywordsTableBody">
                                        <tr>
                                            <td colspan="4" class="no-results">
                                                <i class="fas fa-chart-bar"></i>
                                                <h3>No analysis results yet</h3>
                                                <p>Enter text and click "Analyze Text" to see keyword density results</p>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            
                            <div class="spinner" id="resultsSpinner"></div>
                        </div>
                        
                        <div class="visualization-section">
                            <div class="visualization-title">
                                <i class="fas fa-chart-pie"></i>
                                <span>Data Visualization</span>
                            </div>
                            
                            <div class="visualization-container">
                                <div class="chart-container">
                                    <div class="chart-title">Top 10 Keywords by Density</div>
                                    <div class="chart-placeholder" id="barChartPlaceholder">
                                        Chart will appear here after analysis
                                    </div>
                                </div>
                                
                                <div class="chart-container">
                                    <div class="chart-title">Word Cloud</div>
                                    <div class="word-cloud" id="wordCloud">
                                        <div class="cloud-placeholder">
                                            Word cloud will appear here after analysis
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="instructions">
                <h3><i class="fas fa-info-circle"></i> About Keyword Density</h3>
                <ul>
                    <li><strong>Keyword Density</strong> is the percentage of times a keyword appears in a text compared to the total word count.</li>
                    <li>For SEO purposes, a keyword density of 1-2% is often recommended for primary keywords.</li>
                    <li><strong>Stop words</strong> are common words (like "the", "and", "is") that are often excluded from keyword analysis.</li>
                    <li>Use this tool to optimize your content for search engines and improve readability.</li>
                    <li>Adjust the minimum word length to focus on more meaningful keywords.</li>
                    <li>Export results to track keyword usage across multiple documents.</li>
                </ul>
                
                <h3 style="margin-top: 20px;"><i class="fas fa-lightbulb"></i> Tips for Effective Keyword Analysis</h3>
                <ul>
                    <li>Focus on keywords that are relevant to your content's topic</li>
                    <li>Avoid keyword stuffing - maintain natural language flow</li>
                    <li>Include synonyms and related terms to improve content depth</li>
                    <li>Check competitor content to identify important keywords in your niche</li>
                    <li>Use keyword density as one of many SEO factors, not the only one</li>
                </ul>
            </div>
        </main>
        
        <footer>
            <p>Keyword Density Checker Tool &copy; <span id="currentYear"></span> QuickPDFTool. All rights reserved.</p>
        </footer>
    </div>

    <script>
        // DOM elements
        const textInput = document.getElementById('textInput');
        const wordCount = document.getElementById('wordCount');
        const excludeStopWords = document.getElementById('excludeStopWords');
        const caseSensitive = document.getElementById('caseSensitive');
        const ignoreNumbers = document.getElementById('ignoreNumbers');
        const minLengthSlider = document.getElementById('minLengthSlider');
        const minLengthValue = document.getElementById('minLengthValue');
        const resultsLimitSlider = document.getElementById('resultsLimitSlider');
        const resultsLimitValue = document.getElementById('resultsLimitValue');
        const analyzeBtn = document.getElementById('analyzeBtn');
        const clearBtn = document.getElementById('clearBtn');
        const sampleBtn = document.getElementById('sampleBtn');
        const exportBtn = document.getElementById('exportBtn');
        const copyBtn = document.getElementById('copyBtn');
        const sortBy = document.getElementById('sortBy');
        const totalWords = document.getElementById('totalWords');
        const uniqueWords = document.getElementById('uniqueWords');
        const keywordCount = document.getElementById('keywordCount');
        const avgDensity = document.getElementById('avgDensity');
        const keywordsTableBody = document.getElementById('keywordsTableBody');
        const resultsSpinner = document.getElementById('resultsSpinner');
        const barChartPlaceholder = document.getElementById('barChartPlaceholder');
        const wordCloud = document.getElementById('wordCloud');
        
        // Common stop words to exclude (if option is selected)
        const stopWords = new Set([
            'a', 'an', 'the', 'and', 'or', 'but', 'if', 'because', 'as', 'until', 
            'while', 'of', 'at', 'by', 'for', 'with', 'about', 'against', 'between',
            'into', 'through', 'during', 'before', 'after', 'above', 'below', 'to',
            'from', 'up', 'down', 'in', 'out', 'on', 'off', 'over', 'under', 'again',
            'further', 'then', 'once', 'here', 'there', 'when', 'where', 'why', 'how',
            'all', 'any', 'both', 'each', 'few', 'more', 'most', 'other', 'some', 'such',
            'no', 'nor', 'not', 'only', 'own', 'same', 'so', 'than', 'too', 'very',
            's', 't', 'can', 'will', 'just', 'don', 'should', 'now', 'is', 'are', 'was',
            'were', 'be', 'been', 'being', 'have', 'has', 'had', 'having', 'do', 'does',
            'did', 'doing', 'you', 'your', 'yours', 'he', 'him', 'his', 'she', 'her',
            'hers', 'it', 'its', 'they', 'them', 'their', 'theirs', 'what', 'which',
            'who', 'whom', 'this', 'that', 'these', 'those', 'am', 'is', 'are', 'was',
            'were', 'be', 'been', 'being', 'i', 'me', 'my', 'myself', 'we', 'us', 'our',
            'ours', 'ourselves'
        ]);
        
        // Analysis results
        let analysisResults = {
            totalWords: 0,
            uniqueWords: 0,
            keywords: [],
            keywordData: {}
        };
        
        // Sample text for demonstration
        const sampleText = `Search engine optimization (SEO) is the process of improving the quality and quantity of website traffic to a website or a web page from search engines. SEO targets unpaid traffic rather than direct traffic or paid traffic.

SEO is the practice of increasing both the quality and quantity of website traffic, as well as exposure to your brand, through non-paid search engine results. Despite the acronym, SEO is as much about people as it is about search engines themselves. It's about understanding what people are searching for online, the answers they are seeking, the words they're using, and the type of content they wish to consume.

To be successful with SEO, you need to understand the needs of your audience and create content that meets those needs. This involves keyword research to identify the terms and phrases your target audience uses when searching for information related to your business or industry.

Keyword density is an important aspect of SEO that refers to the percentage of times a keyword appears on a webpage compared to the total number of words on the page. While keyword density was once a major ranking factor, modern search engines use more sophisticated algorithms that focus on content quality and user experience.

However, keyword analysis and optimization remain important for understanding your content's focus and ensuring it aligns with what users are searching for. By analyzing keyword density, you can identify overused terms and optimize your content for better readability and SEO performance.

Effective SEO strategy involves creating high-quality content that provides value to users, optimizing website structure and technical elements, and building authoritative backlinks from other websites. The goal is to create a positive user experience while also signaling to search engines that your content is relevant and valuable.`;
        
        // Initialize the tool
        function init() {
            // Set current year in footer
            document.getElementById('currentYear').textContent = new Date().getFullYear();
            
            // Setup event listeners
            setupEventListeners();
            
            // Initialize UI
            updateWordCount();
            updateSliderValues();
        }
        
        // Setup all event listeners
        function setupEventListeners() {
            // Text input events
            textInput.addEventListener('input', updateWordCount);
            
            // Slider events
            minLengthSlider.addEventListener('input', () => {
                minLengthValue.textContent = minLengthSlider.value;
            });
            
            resultsLimitSlider.addEventListener('input', () => {
                resultsLimitValue.textContent = resultsLimitSlider.value;
            });
            
            // Button events
            analyzeBtn.addEventListener('click', analyzeText);
            clearBtn.addEventListener('click', clearText);
            sampleBtn.addEventListener('click', loadSampleText);
            exportBtn.addEventListener('click', exportResults);
            copyBtn.addEventListener('click', copyResults);
            
            // Sort dropdown event
            sortBy.addEventListener('change', () => {
                if (analysisResults.keywords.length > 0) {
                    renderKeywordsTable();
                }
            });
        }
        
        // Update word count display
        function updateWordCount() {
            const text = textInput.value;
            const words = text.trim().split(/\s+/).filter(word => word.length > 0);
            wordCount.textContent = words.length;
        }
        
        // Update slider display values
        function updateSliderValues() {
            minLengthValue.textContent = minLengthSlider.value;
            resultsLimitValue.textContent = resultsLimitSlider.value;
        }
        
        // Load sample text
        function loadSampleText() {
            textInput.value = sampleText;
            updateWordCount();
        }
        
        // Clear text input
        function clearText() {
            textInput.value = '';
            updateWordCount();
            clearResults();
        }
        
        // Clear analysis results
        function clearResults() {
            analysisResults = {
                totalWords: 0,
                uniqueWords: 0,
                keywords: [],
                keywordData: {}
            };
            
            totalWords.textContent = '0';
            uniqueWords.textContent = '0';
            keywordCount.textContent = '0';
            avgDensity.textContent = '0%';
            
            keywordsTableBody.innerHTML = `
                <tr>
                    <td colspan="4" class="no-results">
                        <i class="fas fa-chart-bar"></i>
                        <h3>No analysis results yet</h3>
                        <p>Enter text and click "Analyze Text" to see keyword density results</p>
                    </td>
                </tr>
            `;
            
            barChartPlaceholder.innerHTML = 'Chart will appear here after analysis';
            wordCloud.innerHTML = '<div class="cloud-placeholder">Word cloud will appear here after analysis</div>';
        }
        
        // Analyze the text
        function analyzeText() {
            const text = textInput.value.trim();
            
            if (!text) {
                alert('Please enter some text to analyze.');
                return;
            }
            
            // Show loading spinner
            resultsSpinner.parentElement.classList.add('loading');
            
            // Use setTimeout to allow UI to update before heavy processing
            setTimeout(() => {
                // Get analysis settings
                const excludeStopWordsFlag = excludeStopWords.checked;
                const caseSensitiveFlag = caseSensitive.checked;
                const ignoreNumbersFlag = ignoreNumbers.checked;
                const minLength = parseInt(minLengthSlider.value);
                const resultsLimit = parseInt(resultsLimitSlider.value);
                
                // Process the text
                processTextAnalysis(text, excludeStopWordsFlag, caseSensitiveFlag, ignoreNumbersFlag, minLength, resultsLimit);
                
                // Hide loading spinner
                resultsSpinner.parentElement.classList.remove('loading');
            }, 50);
        }
        
        // Process text analysis
        function processTextAnalysis(text, excludeStopWords, caseSensitive, ignoreNumbers, minLength, resultsLimit) {
            // Clean and normalize the text
            let normalizedText = text;
            
            if (!caseSensitive) {
                normalizedText = normalizedText.toLowerCase();
            }
            
            // Remove punctuation and special characters (keep letters, numbers, and spaces)
            normalizedText = normalizedText.replace(/[^\w\s]/g, ' ');
            
            // Split into words
            let words = normalizedText.split(/\s+/).filter(word => word.length > 0);
            
            // Store total word count
            const totalWordCount = words.length;
            
            // Filter words based on settings
            words = words.filter(word => {
                // Check minimum length
                if (word.length < minLength) return false;
                
                // Check if we should ignore numbers
                if (ignoreNumbers && /^\d+$/.test(word)) return false;
                
                // Check if we should exclude stop words
                if (excludeStopWords && stopWords.has(word.toLowerCase())) return false;
                
                return true;
            });
            
            // Count word frequency
            const wordCounts = {};
            words.forEach(word => {
                wordCounts[word] = (wordCounts[word] || 0) + 1;
            });
            
            // Convert to array and sort by frequency (descending)
            let keywordArray = Object.keys(wordCounts).map(keyword => ({
                keyword,
                frequency: wordCounts[keyword],
                density: (wordCounts[keyword] / totalWordCount) * 100
            }));
            
            // Sort by frequency (descending)
            keywordArray.sort((a, b) => b.frequency - a.frequency);
            
            // Limit results
            keywordArray = keywordArray.slice(0, resultsLimit);
            
            // Calculate unique words count
            const uniqueWordCount = Object.keys(wordCounts).length;
            
            // Calculate average density of top keywords
            const avgDensityValue = keywordArray.length > 0 
                ? (keywordArray.reduce((sum, item) => sum + item.density, 0) / keywordArray.length).toFixed(2)
                : 0;
            
            // Update analysis results
            analysisResults = {
                totalWords: totalWordCount,
                uniqueWords: uniqueWordCount,
                keywords: keywordArray,
                keywordData: wordCounts
            };
            
            // Update UI with results
            updateResultsUI();
        }
        
        // Update UI with analysis results
        function updateResultsUI() {
            // Update summary cards
            totalWords.textContent = analysisResults.totalWords.toLocaleString();
            uniqueWords.textContent = analysisResults.uniqueWords.toLocaleString();
            keywordCount.textContent = analysisResults.keywords.length.toLocaleString();
            avgDensity.textContent = analysisResults.keywords.length > 0 
                ? `${((analysisResults.keywords.reduce((sum, item) => sum + item.density, 0) / analysisResults.keywords.length)).toFixed(2)}%`
                : '0%';
            
            // Render keywords table
            renderKeywordsTable();
            
            // Create visualizations
            createVisualizations();
        }
        
        // Render keywords table
        function renderKeywordsTable() {
            if (analysisResults.keywords.length === 0) {
                keywordsTableBody.innerHTML = `
                    <tr>
                        <td colspan="4" class="no-results">
                            <i class="fas fa-chart-bar"></i>
                            <h3>No keywords found</h3>
                            <p>Try adjusting your analysis settings</p>
                        </td>
                    </tr>
                `;
                return;
            }
            
            // Sort keywords based on selected option
            let sortedKeywords = [...analysisResults.keywords];
            const sortOption = sortBy.value;
            
            switch(sortOption) {
                case 'frequency-asc':
                    sortedKeywords.sort((a, b) => a.frequency - b.frequency);
                    break;
                case 'density':
                    sortedKeywords.sort((a, b) => b.density - a.density);
                    break;
                case 'density-asc':
                    sortedKeywords.sort((a, b) => a.density - b.density);
                    break;
                case 'alphabetical':
                    sortedKeywords.sort((a, b) => a.keyword.localeCompare(b.keyword));
                    break;
                case 'alphabetical-desc':
                    sortedKeywords.sort((a, b) => b.keyword.localeCompare(a.keyword));
                    break;
                default: // 'frequency' (default)
                    sortedKeywords.sort((a, b) => b.frequency - a.frequency);
            }
            
            // Build table rows
            let tableHTML = '';
            
            sortedKeywords.forEach((item, index) => {
                const percentage = item.density.toFixed(2);
                const percentageBarWidth = Math.min(item.density * 5, 100); // Scale for visualization
                
                // Determine row color class based on rank
                let rowClass = '';
                if (index < 3) rowClass = 'top-keyword';
                
                tableHTML += `
                    <tr class="${rowClass}">
                        <td class="keyword-cell">
                            <span class="keyword-rank">${index + 1}.</span> ${item.keyword}
                        </td>
                        <td class="frequency-cell">${item.frequency}</td>
                        <td class="percentage-cell">${percentage}%</td>
                        <td>
                            <div class="percentage-bar-container">
                                <div class="percentage-bar" style="width: ${percentageBarWidth}%"></div>
                            </div>
                        </td>
                    </tr>
                `;
            });
            
            keywordsTableBody.innerHTML = tableHTML;
        }
        
        // Create visualizations
        function createVisualizations() {
            if (analysisResults.keywords.length === 0) {
                barChartPlaceholder.innerHTML = 'No data available for visualization';
                wordCloud.innerHTML = '<div class="cloud-placeholder">No data available for word cloud</div>';
                return;
            }
            
            // Create bar chart placeholder with simple HTML/CSS bars
            createSimpleBarChart();
            
            // Create word cloud
            createWordCloud();
        }
        
        // Create simple bar chart with HTML/CSS
        function createSimpleBarChart() {
            // Get top 10 keywords by density
            const topKeywords = [...analysisResults.keywords]
                .sort((a, b) => b.density - a.density)
                .slice(0, 10);
            
            if (topKeywords.length === 0) {
                barChartPlaceholder.innerHTML = 'No data available for chart';
                return;
            }
            
            // Find max density for scaling
            const maxDensity = Math.max(...topKeywords.map(item => item.density));
            
            // Create chart HTML
            let chartHTML = '<div class="simple-bar-chart">';
            
            topKeywords.forEach(item => {
                const barHeight = (item.density / maxDensity) * 100;
                const colorIndex = topKeywords.indexOf(item) % 5 + 1;
                const colorVar = `var(--keyword-${colorIndex})`;
                
                chartHTML += `
                    <div class="bar-chart-item">
                        <div class="bar-label">${item.keyword}</div>
                        <div class="bar-container">
                            <div class="bar" style="height: ${barHeight}%; background-color: ${colorVar};"></div>
                        </div>
                        <div class="bar-value">${item.density.toFixed(2)}%</div>
                    </div>
                `;
            });
            
            chartHTML += '</div>';
            
            // Add CSS for the chart
            const chartCSS = `
                <style>
                    .simple-bar-chart {
                        display: flex;
                        height: 200px;
                        align-items: flex-end;
                        justify-content: space-between;
                        padding: 20px 0;
                    }
                    
                    .bar-chart-item {
                        display: flex;
                        flex-direction: column;
                        align-items: center;
                        width: 9%;
                    }
                    
                    .bar-label {
                        font-size: 0.7rem;
                        text-align: center;
                        margin-bottom: 8px;
                        font-weight: 600;
                        color: var(--dark-gray);
                        height: 30px;
                        overflow: hidden;
                        display: -webkit-box;
                        -webkit-line-clamp: 2;
                        -webkit-box-orient: vertical;
                    }
                    
                    .bar-container {
                        width: 100%;
                        height: 120px;
                        display: flex;
                        align-items: flex-end;
                        background-color: var(--light-blue);
                        border-radius: 4px 4px 0 0;
                        overflow: hidden;
                    }
                    
                    .bar {
                        width: 100%;
                        transition: height 0.5s ease;
                        border-radius: 4px 4px 0 0;
                    }
                    
                    .bar-value {
                        font-size: 0.8rem;
                        font-weight: 600;
                        margin-top: 5px;
                        color: var(--dark-blue);
                    }
                </style>
            `;
            
            barChartPlaceholder.innerHTML = chartCSS + chartHTML;
        }
        
        // Create word cloud
        function createWordCloud() {
            // Get keywords for word cloud (top 30 by frequency)
            const cloudKeywords = [...analysisResults.keywords]
                .sort((a, b) => b.frequency - a.frequency)
                .slice(0, 30);
            
            if (cloudKeywords.length === 0) {
                wordCloud.innerHTML = '<div class="cloud-placeholder">No data available for word cloud</div>';
                return;
            }
            
            // Find min and max frequency for scaling
            const minFreq = Math.min(...cloudKeywords.map(item => item.frequency));
            const maxFreq = Math.max(...cloudKeywords.map(item => item.frequency));
            
            // Create word cloud HTML
            wordCloud.innerHTML = '';
            
            cloudKeywords.forEach(item => {
                // Calculate font size based on frequency (scaled between 14px and 36px)
                const fontSize = 14 + ((item.frequency - minFreq) / (maxFreq - minFreq)) * 22;
                
                // Determine color based on density
                const density = item.density;
                let color;
                
                if (density > 2) color = 'var(--keyword-4)'; // High density - red
                else if (density > 1) color = 'var(--keyword-3)'; // Medium density - orange
                else if (density > 0.5) color = 'var(--keyword-2)'; // Low density - green
                else color = 'var(--keyword-1)'; // Very low density - blue
                
                // Create word element
                const wordElement = document.createElement('div');
                wordElement.className = 'cloud-word';
                wordElement.textContent = item.keyword;
                wordElement.style.fontSize = `${fontSize}px`;
                wordElement.style.color = color;
                wordElement.style.backgroundColor = color === 'var(--keyword-1)' ? 'rgba(44, 123, 229, 0.1)' : 
                                                 color === 'var(--keyword-2)' ? 'rgba(40, 167, 69, 0.1)' :
                                                 color === 'var(--keyword-3)' ? 'rgba(253, 126, 20, 0.1)' :
                                                 'rgba(220, 53, 69, 0.1)';
                
                // Add click event to filter by this keyword
                wordElement.addEventListener('click', () => {
                    textInput.value = textInput.value + ' ' + item.keyword;
                    updateWordCount();
                });
                
                wordCloud.appendChild(wordElement);
            });
        }
        
        // Export results as CSV
        function exportResults() {
            if (analysisResults.keywords.length === 0) {
                alert('No results to export. Please analyze some text first.');
                return;
            }
            
            // Create CSV content
            let csvContent = 'Keyword,Frequency,Density(%)\n';
            
            analysisResults.keywords.forEach(item => {
                csvContent += `"${item.keyword}",${item.frequency},${item.density.toFixed(2)}\n`;
            });
            
            // Add summary at the end
            csvContent += `\nSummary\n`;
            csvContent += `Total Words,${analysisResults.totalWords}\n`;
            csvContent += `Unique Words,${analysisResults.uniqueWords}\n`;
            csvContent += `Keywords Found,${analysisResults.keywords.length}\n`;
            csvContent += `Average Density,${avgDensity.textContent}\n`;
            
            // Create download link
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.setAttribute('href', url);
            link.setAttribute('download', `keyword-density-analysis-${new Date().toISOString().slice(0,10)}.csv`);
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            // Show feedback
            showFeedback(exportBtn, 'Exported!');
        }
        
        // Copy results to clipboard
        function copyResults() {
            if (analysisResults.keywords.length === 0) {
                alert('No results to copy. Please analyze some text first.');
                return;
            }
            
            // Create text summary
            let textContent = `Keyword Density Analysis Results\n`;
            textContent += `===============================\n\n`;
            textContent += `Summary:\n`;
            textContent += `- Total Words: ${analysisResults.totalWords}\n`;
            textContent += `- Unique Words: ${analysisResults.uniqueWords}\n`;
            textContent += `- Keywords Found: ${analysisResults.keywords.length}\n`;
            textContent += `- Average Density: ${avgDensity.textContent}\n\n`;
            textContent += `Top Keywords:\n`;
            
            // Add top 10 keywords
            analysisResults.keywords.slice(0, 10).forEach((item, index) => {
                textContent += `${index + 1}. ${item.keyword}: ${item.frequency} occurrences (${item.density.toFixed(2)}%)\n`;
            });
            
            textContent += `\nGenerated by QuickPDFTool Keyword Density Checker`;
            
            // Copy to clipboard
            navigator.clipboard.writeText(textContent).then(() => {
                showFeedback(copyBtn, 'Copied!');
            }).catch(err => {
                console.error('Failed to copy: ', err);
                alert('Failed to copy results. Please try again.');
            });
        }
        
        // Show feedback on button
        function showFeedback(button, message) {
            const originalText = button.querySelector('span').textContent;
            const originalIcon = button.querySelector('i').className;
            
            button.classList.add('copied');
            button.querySelector('span').textContent = message;
            button.querySelector('i').className = 'fas fa-check';
            
            // Reset button after 2 seconds
            setTimeout(() => {
                button.classList.remove('copied');
                button.querySelector('span').textContent = originalText;
                button.querySelector('i').className = originalIcon;
            }, 2000);
        }
        
        // Initialize on page load
        window.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
